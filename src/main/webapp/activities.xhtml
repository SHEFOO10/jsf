<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>
    <title>Activity Management</title>
    
</h:head>
<h:body>
	
		<ui:composition template="/WEB-INF/includes/layouts/layout.xhtml">
			<ui:define name="content">
				<h:form id="activityForm">
            <!-- List of activitys -->
            <h3 style="text-align: center;">Activities List</h3>
            <div id="tableWrapper">
            <div class="d-flex flex-wrap justify-content-center">
	           	<ui:repeat value="#{activityBean.activities}" var="activity">
	           	
	           		<div class="card" style="width: 20rem; margin: 15px;">
						  <!-- <img src="#{resource['/uploads/placeholder.jpg']}" class="card-img-top" alt="..." /> -->
						  <div class="card-body">
						    <h5 class="card-title">#{activity.name}</h5>
							<p class="ms-2 pe-2">#{activity.description}</p>
							<p class="ms-2">Min Age: #{activity.min_age}</p>
							<p class="ms-2">Max Age: #{activity.max_age}</p>
							<hr/>
							<h6>Skills</h6>
						  <h:panelGroup rendered="#{activity.skills.size() > 0}">
								  <div>
									<ui:repeat value="#{activity.skills}" var="skill">
								    	<span class="btn btn-warning mx-1 mb-2">#{skill.name}</span>
									</ui:repeat>
			                  	  </div>
						  </h:panelGroup>
						  <h:panelGroup rendered="#{empty activity.skills}">
						  	<p>No Skills Required</p>
						  </h:panelGroup>
						</div>
						  <div class="mb-3 d-flex justify-content-end px-2">
							  
							  <h:commandButton class="btn btn-danger rounded-pill px-3 me-2" value="Delete" action="#{activityBean.deleteActivity(activity.id)}" immediate="true" />
							  <h:commandButton class="btn btn-primary rounded-pill px-3 me-2" value="Edit" action="#{activityBean.editActivity(activity.id)}"/>
						  </div>
						</div>
	           	</ui:repeat>
           	</div>
           </div>
        <!-- Form for creating/editing a activity -->
       
       	<div style="width: 100%; text-align: center;">
       		<h3>#{activityBean.newActivity.id == 0 ? 'Create New Activity' : 'Edit Activity'}</h3>
       	</div>
        <div style="width: 100%; display: flex; justify-content: center; margin-block: 20px;">
        	<div id="formContainer">
	        	<div>
			        <h:outputLabel for="name" value="Name:" />
			        <p><h:inputText id="name" value="#{activityBean.newActivity.name}"/></p>
			        <h:message for="name" style="color:red;" />
	        	</div>
	
				<div>
		            <h:outputLabel for="description" value="Description:" />
		            <p><h:inputText id="description" value="#{activityBean.newActivity.description}"  /></p>
		            <h:message for="description" style="color: red" />
				</div>
				<div>
		            <h:outputLabel for="min_age" value="Min Age:" />
		            <p><h:inputText id="min_age" value="#{activityBean.newActivity.min_age}" converter="javax.faces.Integer" converterMessage="Min age must be a valid number.">
            	        <f:ajax event="change" render="min_age" />
		            </h:inputText>
		           </p>
		            <h:message for="min_age" style ="color: red;"/>
				</div>
	
				<div>
		            <h:outputLabel for="max_age" value="Max Age:" />
		            <p><h:inputText id="max_age" value="#{activityBean.newActivity.max_age}" converter="javax.faces.Integer" converterMessage="Max age must be a valid number." >
			        <f:attribute name="minAge" value="#{activityBean.newActivity.min_age}" />
			        <f:validator validatorId="activityValidator" />
		            </h:inputText></p>
					<h:message for="max_age" style="color: red;" />
				</div>
	
				<div style="width: 100%; grid-column: 2 span; display: flex; justify-content: space-evenly">
			        <h:commandButton value="Save" action="#{activityBean.addActivity}" />
					<h:commandButton value="Reset" action="#{activityBean.resetInputs}"/>
				</div>
        	</div>
        </div>        



 
    </h:form>
			</ui:define>
		</ui:composition>
</h:body>
</html>
